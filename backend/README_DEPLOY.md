# CS2 Analytics Backend

Backend —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –º–∞—Ç—á–µ–π CS2 –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd backend
npm install
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–§–∞–π–ª `.env` —É–∂–µ —Å–æ–∑–¥–∞–Ω —Å –≤–∞—à–∏–º–∏ –∫–ª—é—á–∞–º–∏ API:

```env
PORT=3000
BROWSERLESS_API_KEY=2TO87BeFLtlmUIX274fd6c0a4fab3da48c2bd3d2c7b8cf67b
SCRAPER_API_KEY=d8a5c9b77c6a7bcdd64582811f9534ce
NODE_ENV=production
```

### 3. –°–±–æ—Ä–∫–∞

```bash
npm run build
```

### 4. –ó–∞–ø—É—Å–∫

**–õ–æ–∫–∞–ª—å–Ω–æ (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞):**
```bash
npm run dev
```

**Production:**
```bash
npm start
```

## üì¶ –î–µ–ø–ª–æ–π –Ω–∞ Render.com

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ GitHub

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ó–∞–ª–µ–π—Ç–µ –ø–∞–ø–∫—É `backend` –≤ –∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
cd backend
git init
git add .
git commit -m "Initial commit: CS2 Analytics Backend"
git branch -M main
git remote add origin <–≤–∞—à-github-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π>
git push -u origin main
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Render.com

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [render.com](https://render.com)
2. –ù–∞–∂–º–∏—Ç–µ **"New +"** ‚Üí **"Web Service"**
3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–∞—à GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

**Basic Settings:**
- **Name:** `cs2-analytics-backend`
- **Region:** –≤—ã–±–µ—Ä–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π —Ä–µ–≥–∏–æ–Ω
- **Branch:** `main`
- **Root Directory:** –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º (–µ—Å–ª–∏ backend –≤ –∫–æ—Ä–Ω–µ) –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ `backend`
- **Runtime:** `Node`

**Build & Deploy:**
- **Build Command:** `npm install && npm run build`
- **Start Command:** `npm start`

**Environment Variables:**
–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `NODE_ENV` = `production`
- `PORT` = `3000`
- `BROWSERLESS_API_KEY` = `2TO87BeFLtlmUIX274fd6c0a4fab3da48c2bd3d2c7b8cf67b`
- `SCRAPER_API_KEY` = `d8a5c9b77c6a7bcdd64582811f9534ce`

5. –ù–∞–∂–º–∏—Ç–µ **"Create Web Service"**

### –®–∞–≥ 3: –ü–æ–ª—É—á–∏—Ç–µ URL

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ URL –≤–∏–¥–∞:
```
https://cs2-analytics-backend.onrender.com
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç URL - –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è!

## üîå API Endpoints

### –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
```
GET /
```

### Health Check
```
GET /health
```

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –º–∞—Ç—á–∏
```
GET /api/matches
```

**Response:**
```json
{
  "success": true,
  "data": [...],
  "cached": false,
  "timestamp": "2025-01-10T12:00:00Z"
}
```

### –ü–æ–ª—É—á–∏—Ç—å –º–∞—Ç—á –ø–æ ID
```
GET /api/matches/:id
```

### –ê–Ω–∞–ª–∏–∑ –º–∞—Ç—á–∞
```
POST /api/matches/:id/analyze
```

**Response:**
```json
{
  "success": true,
  "data": {
    "teamAnalysis": {...},
    "h2h": [...],
    "mapPredictions": [...],
    "overallPrediction": {...},
    "news": [...]
  }
}
```

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts         # API –∫–ª—é—á–∏, –ø–æ—Ä—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ scraper/             # Web scraping –º–æ–¥—É–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ browserless.ts   # Browserless –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ scraperapi.ts    # ScraperAPI –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hltv.ts          # HLTV scraper
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ liquidpedia.ts   # Liquidpedia scraper
‚îÇ   ‚îú‚îÄ‚îÄ services/            # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analyzer.ts      # –ê–Ω–∞–ª–∏–∑ –∏ –ø—Ä–æ–≥–Ω–æ–∑—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cache.ts         # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ routes/              # API —Ä–æ—É—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ matches.ts       # /api/matches
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health.ts        # /health
‚îÇ   ‚îú‚îÄ‚îÄ types/               # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îî‚îÄ‚îÄ index.ts             # Entry point
‚îú‚îÄ‚îÄ dist/                    # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ .env                     # Environment variables
‚îú‚îÄ‚îÄ .env.example             # –ü—Ä–∏–º–µ—Ä .env
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îî‚îÄ‚îÄ render.yaml              # –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è Render.com
```

## ‚öôÔ∏è –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è:** Live –º–∞—Ç—á–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
‚úÖ **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** –ö–æ–º–∞–Ω–¥—ã, –∏–≥—Ä–æ–∫–∏, –∫–∞—Ä—Ç—ã
‚úÖ **AI –ø—Ä–æ–≥–Ω–æ–∑—ã:** –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–±–µ–¥—ã, —Ç–æ—Ç–∞–ª –∫–∞—Ä—Ç
‚úÖ **–ò—Å—Ç–æ—Ä–∏—è H2H:** –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤—Å—Ç—Ä–µ—á–∏ –∫–æ–º–∞–Ω–¥
‚úÖ **–°–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏:** –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
‚úÖ **–û–±—Ö–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:** Browserless + ScraperAPI

## üîß –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

- **Matches:** 2 –º–∏–Ω—É—Ç—ã
- **Analysis:** 10 –º–∏–Ω—É—Ç
- **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞:** –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ `src/services/cache.ts`

## üêõ Troubleshooting

### "Failed to scrape"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á–∏ –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ HLTV –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã Browserless/ScraperAPI

### –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –≤—Å–µ–≥–¥–∞ –º–µ–¥–ª–µ–Ω–Ω—ã–π (scraping)
- –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—ç—à
- –ù–∞ Render.com –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω –∑–∞—Å—ã–ø–∞–µ—Ç —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### –û—à–∏–±–∫–∏ –Ω–∞ Render.com
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Dashboard
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ env variables —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Build Command –∏ Start Command

## üìä –õ–∏–º–∏—Ç—ã API

**Browserless (Free):**
- 1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü
- –ú–æ–∂–Ω–æ –∞–ø–≥—Ä–µ–π–¥–∏—Ç—å –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω

**ScraperAPI (Free):**
- 1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü
- –ú–æ–∂–Ω–æ –∞–ø–≥—Ä–µ–π–¥–∏—Ç—å –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Helmet –¥–ª—è HTTP headers
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤—Å–µ—Ö origins
- Rate limiting –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
- API –∫–ª—é—á–∏ –≤ environment variables

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
```
[HLTV] Fetching matches...
[Browserless] Scraping: https://...
[Cache] Hit: all_matches (age: 45s)
[API] GET /api/matches - Returning cached matches
```

## üöÄ Production Tips

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ UptimeRobot –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
2. **–õ–æ–≥–∏:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Render Dashboard –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–≤–µ–ª–∏—á—å—Ç–µ –ø–ª–∞–Ω Render
4. **CDN:** –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Cloudflare –ø–µ—Ä–µ–¥ Render

## üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –º–æ–±–∏–ª—å–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ–±–Ω–æ–≤–∏—Ç–µ URL –≤ –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:

```typescript
// –í –≤–∞—à–µ–º React Native –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
const API_URL = 'https://cs2-analytics-backend.onrender.com';
```

## ‚ùì –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ Render Dashboard
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ environment variables —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å HLTV.org
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã API –∫–ª—é—á–µ–π
