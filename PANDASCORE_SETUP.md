# Интеграция PandaScore API

## Что такое PandaScore?

PandaScore - это API для киберспортивной статистики, которое предоставляет данные о матчах, командах, игроках и турнирах по CS2 и другим играм.

## Преимущества PandaScore

- ✅ Официальный API с документацией
- ✅ Надежные данные о матчах в реальном времени
- ✅ Статистика команд и игроков
- ✅ История встреч (H2H)
- ✅ Статистика по картам
- ✅ Информация о стримах

## Получение API ключа

1. Перейдите на [https://pandascore.co](https://pandascore.co)
2. Нажмите "Sign Up" и создайте аккаунт
3. После регистрации перейдите в раздел "API Keys"
4. Создайте новый API ключ
5. Скопируйте ключ (он будет показан только один раз!)

## Настройка в проекте

### 1. Добавьте API ключ в .env

Откройте файл `backend/.env` и добавьте строку:

```
PANDASCORE_API_KEY=your_api_key_here
```

Замените `your_api_key_here` на ваш реальный API ключ.

### 2. Деплой на Render.com

Если вы используете Render.com для хостинга:

1. Перейдите в [https://dashboard.render.com](https://dashboard.render.com)
2. Выберите ваш сервис CS2 Backend
3. Перейдите в "Environment" в левом меню
4. Нажмите "Add Environment Variable"
5. Добавьте:
   - Key: `PANDASCORE_API_KEY`
   - Value: ваш API ключ
6. Нажмите "Save Changes"
7. Сервис автоматически перезапустится

## Как это работает

### Scrapers

Теперь в проекте работают 3 источника данных:

1. **HLTV** (`backend/src/scraper/hltv.ts`)
   - Матчи с HLTV.org
   - Новости
   - Статистика команд

2. **Liquidpedia** (`backend/src/scraper/liquidpedia.ts`)
   - Статистика команд
   - Статистика игроков
   - История встреч (H2H)
   - Статистика по картам

3. **PandaScore** (`backend/src/scraper/pandascore.ts`) ✨ НОВОЕ
   - Официальное API
   - Матчи в реальном времени
   - Статистика команд
   - Статистика игроков
   - История встреч (H2H)
   - Статистика по картам

### Объединение данных

Данные из всех трех источников объединяются для максимальной точности:

- **Матчи**: Показываются из всех источников (дедупликация по названию команд)
- **Статистика**: Данные из HLTV, Liquidpedia и PandaScore объединяются
- **H2H**: История из всех источников сортируется по дате
- **Статистика по картам**: Усредняется между источниками

## API Endpoints

Все endpoints остались прежними:

- `GET /api/matches` - Получить все матчи (теперь включает данные из PandaScore)
- `GET /api/matches/:id` - Получить конкретный матч
- `POST /api/matches/:id/analyze` - Проанализировать матч (использует данные из всех источников)

## Лимиты PandaScore

PandaScore имеет лимиты на количество запросов:

- **Free план**: 1,000 запросов в месяц
- **Starter план**: 10,000 запросов в месяц ($19/месяц)
- **Pro план**: 100,000 запросов в месяц ($99/месяц)

**Важно**: Приложение использует кэширование, чтобы минимизировать количество запросов к API.

## Проверка работы

После настройки API ключа:

1. Откройте консоль логов вашего сервера (Render.com dashboard)
2. Вы должны увидеть:
   ```
   Config loaded: {
     ...
     pandascoreConfigured: true
   }
   ```

3. При запросе матчей вы увидите:
   ```
   [PandaScore] Fetching CS2 matches...
   [PandaScore] Found X matches
   ```

## Устранение проблем

### "PANDASCORE_API_KEY not set"

Убедитесь, что:
- API ключ добавлен в `.env` файл
- На Render.com ключ добавлен в Environment Variables
- Сервис был перезапущен после добавления ключа

### "Error fetching from PandaScore"

Проверьте:
- API ключ корректен
- Лимиты запросов не превышены
- Интернет соединение работает

### Нет данных из PandaScore

Даже если PandaScore не работает, приложение продолжит использовать HLTV и Liquidpedia. Проверьте логи для более подробной информации.

## Дополнительная информация

- Документация PandaScore API: [https://developers.pandascore.co](https://developers.pandascore.co)
- Discord сообщество: [https://discord.gg/pandascore](https://discord.gg/pandascore)
